@using Basyc.Diagnostics.Shared.Durations
@using Basyc.MessageBus.Manager.Application.ResultDiagnostics

<horizontalDurationMapView>
    @foreach (var service in map)
    {
        <service>
            <serviceName>
                @service.Key.ServiceName
            </serviceName>
            <durationBoxes>
                @foreach (var activity in service.Value)
                {
                    @activity.DisplayName
                }
            </durationBoxes>
        </service>

    }
</horizontalDurationMapView>



@code {
    [Parameter] public List<Activity> Activities { get; set; }
    [Parameter] public double Scale { get; set; } = 20;

    private Dictionary<ServiceIdentity, List<Activity>> map = new Dictionary<ServiceIdentity, List<Activity>>();

    protected override void OnInitialized()
    {
        foreach (var activity in Activities)
        {
            map.TryAdd(activity.Service, new());
            var activities = map[activity.Service];
            activities.Add(activity);
        }
        base.OnInitialized();
    }
}
