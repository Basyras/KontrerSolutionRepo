@using Basyc.MessageBus.Manager.Application.ResultDiagnostics
@using Basyc.MessageBus.Manager.Application
@using Basyc.MessageBus.Manager.Presentation.BlazorLibrary.Components
@using Basyc.MessageBus.Manager.Presentation.BlazorLibrary.Components.DurationMap
@using Basyc.MessageBus.Manager.Presentation.BlazorLibrary.Components.LogWindow
@using Basyc.MessageBus.Manager.Presentation.BlazorLibrary.Shared.Helpers

<resultHistoryItemExpandedView>
    <basicSection>
        <basicTable>
            <MudGrid Spacing="0">
                <MudItem lg="6">
                    <MudStack Spacing="2">
                        <formLabel>
                            StartTime
                        </formLabel>
                        <formLabel>
                            State
                        </formLabel>
                        <formLabel>
                            Duration
                        </formLabel>
                        <formLabel>
                            TraceId
                        </formLabel>
                    </MudStack>
                </MudItem>
                <MudItem lg="6">
                    <MudStack Spacing="2">
                        <formValue>
                            @if (RequestResult.DurationMap != null)
                            {
                                @TimeConverter.TimeToText(RequestResult.DurationMap.StartTime)
                            }
                        </formValue>
                        <formValue>
                            @RequestResult.State.ToString()
                        </formValue>
                        <formValue>
                            <LatencyView RequestResult="RequestResult" />
                        </formValue>
                        <formValue>
                            @RequestResult.TraceId
                        </formValue>
                    </MudStack>
                </MudItem>
            </MudGrid>
        </basicTable>

        <dataSubSection>
            <requestBox>
                @ResponseResultConverter.CreateInputOverview(RequestResult.Request.Parameters)
            </requestBox>
            <arrow>
                <MudIcon Icon="@Icons.Material.Rounded.Forward" />
            </arrow>
            <responseBox>
                @RequestResult.Response
            </responseBox>
        </dataSubSection>

    </basicSection>
    <activityMapSecion>
        <sectionLabel>
            ActivityMap
        </sectionLabel>
        <DurationMapView Scale="20" DurationMap="RequestResult.DurationMap" />
    </activityMapSecion>
    <logsSection>
        <sectionLabel class="sectionLabel--logs">
            Logs
        </sectionLabel>
        <LogWindowView DiagnosticsContext="DiagnosticsContext" />
    </logsSection>
</resultHistoryItemExpandedView>


@code {
    [Parameter]
    public RequestResult RequestResult { get; set; }

    [Parameter]
    public RequestDiagnosticsContext DiagnosticsContext { get; set; }
}
